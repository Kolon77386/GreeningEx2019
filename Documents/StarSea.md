# ステージ選択シーンの星の海の色変化
ステージ選択シーンで、クリアした島の周りを、綺麗な海に切り替える。

## 方法
島の形状に合わせて色を変える場所を調整したいので、モデルの頂点から、影響が出るテクスチャーのUV値を求めて変化の度合いを決めたい。シェーダーでもできそうだが、スペキュラーの変更などもしたいので、調べるのがやや面倒である。そこで、Standardシェーダーを使ってAlbedoに貼り付けたテクスチャーを動的に書き換えることで実現する。

## 球体からUVへの変換
テクスチャーを貼り付けて調査したところ、星のUV値は以下の通りであった。

- 球体の上は、Vが0。Uはどこでも同じなので、0でよいだろう
- 球体の下は、Vが1。Uはどこでも同じなので、1でよいだろう
- 経度は、手前が3/16、右方向が7/16、奥が11/16、左が15/16

以上から、中心からの方向を与えて、UV値を算出することができる。

## 島の座標
島の座標は、星のモデルのverticesから算出する。

- Mesh Filterの値を参照するので、Projectウィンドウでモデルデータを選択して、InspectorウィンドウでModelを選択して、*Read/Wite Enabled*にチェックを入れておく
- モデル座標からワールド座標への位置の変換は、transform.TransformPoint()を利用すると楽

以上を計算して、島の頂点を算出する。

## 海の色の割合
海のテクスチャーは、64～256程度の粗いもので計算する。頂点から島の影響を受ける距離を定義して、各頂点ごとにUV値を計算して、そこから既定の範囲にクリア状況の色を反映させる。

- 島からの距離に応じて、影響力と色を算出する
  - int 影響値 未クリア(-1) or 影響なし(0) or クリア(1)
  - float 割合 0～1
- 全ての島について、上記の(影響値*割合)を合計して、0～1でクランプした値で、未クリアとクリアの割合を算出する

色はアニメーションさせたいので、前後の状態をそれぞれテクスチャーで作成して、それらを割合で合成できるようにする。
